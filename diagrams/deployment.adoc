:backend: revealjs
:revealjs_theme: white
:customcss: common.css
:revealjs_transition: none

== А что, собственно, деплоим?
["graphviz", "main_scheme_joke", "svg"]
---------------------------------------------------------------------
digraph main {
  rankdir = LR;
  source [shape=polygon,sides=5,peripheries=3,color=lightblue,style=filled,label="Исходный \nсайт"];
  spectator [shape=polygon,sides=5,peripheries=3,color=orange,style=filled,label="Пользователь"];
  source -> spectator[label="data"];
---------------------------------------------------------------------

=== А что, собственно, деплоим?
["graphviz", "main_scheme_1", "svg"]
---------------------------------------------------------------------
digraph main {
  rankdir = LR;
  source [shape=polygon,sides=5,peripheries=3,color=lightblue,style=filled,label="Исходный \nсайт"];
  spectator [shape=polygon,sides=5,peripheries=3,color=orange,style=filled,label="Пользователь"];

  source -> service_1;
  service_1 -> redis -> service_1;
  service_2 -> redis -> service_2;
  service_1 -> kafka;
  service_3 -> kafka -> service_3;
  kafka -> service_4;

  service_4 -> ingress;
  ingress -> spectator;

  subgraph mainline {
    label = "Main line";
    service_1 [shape=diamond];
    service_2 [shape=diamond];
    service_3 [shape=diamond];
    service_4 [shape=diamond];
  }

  subgraph side_services {
    label = "Side services";
    rank = same;
    redis [shape=box]
    kafka [shape=box]
  }
}
---------------------------------------------------------------------

["graphviz", "main_scheme_legend", "svg"]
---------------------------------------------------------------------
digraph main {
  service [shape=diamond,label="Наши сервисы"];
  side_service [shape=box, label="Сторонние сервисы"];
}
---------------------------------------------------------------------
  
=== А что, собственно, деплоим?
["graphviz", "main_scheme_2", "svg"]
---------------------------------------------------------------------
digraph main {
  rankdir = LR;
  source [shape=polygon,sides=5,peripheries=3,color=lightblue,style=filled,label="Исходный \nсайт"];
  spectator [shape=polygon,sides=5,peripheries=3,color=orange,style=filled,label="Пользователь"];

  source -> service_1;
  service_1 -> redis -> service_1;
  service_2 -> redis -> service_2;
  service_1 -> kafka;
  service_3 -> kafka -> service_3;
  kafka -> service_4;

  service_4 -> ingress;
  ingress -> spectator;

  subgraph mainline {
    label = "Main line";
    service_1 [shape=diamond];
    service_2 [shape=diamond];
    service_3 [shape=diamond];
    service_4 [shape=diamond];
  }

  subgraph side_services {
    label = "Side services";
    rank = same;
    redis [shape=box]
    kafka [shape=box]
  }

  subgraph support {
    label = "Support";
    rank = same;
    dns_manager [shape=box];
    cert_manager [shape=box];
    load_balancer [shape=box];
    ingress [shape=box];
  }
  load_balancer, dns_manager, cert_manager -> ingress;
---------------------------------------------------------------------

["graphviz", "main_scheme_legend", "svg"]
---------------------------------------------------------------------
digraph main {
  service [shape=diamond,label="Наши сервисы"];
  side_service [shape=box, label="Сторонние сервисы"];
}
---------------------------------------------------------------------

=== А что, собственно, деплоим?
["graphviz", "main_scheme_3", "svg"]
---------------------------------------------------------------------
digraph main {
  rankdir = LR;
  source [shape=polygon,sides=5,peripheries=3,color=lightblue,style=filled,label="Исходный \nсайт"];
  spectator [shape=polygon,sides=5,peripheries=3,color=orange,style=filled,label="Пользователь"];

  source -> service_1;
  service_1 -> redis -> service_1;
  service_2 -> redis -> service_2;
  service_1 -> kafka;
  service_3 -> kafka -> service_3;
  kafka -> service_4;

  service_4 -> ingress;
  ingress -> spectator;

  subgraph mainline {
    label = "Main line";
    service_1 [shape=diamond];
    service_2 [shape=diamond];
    service_3 [shape=diamond];
    service_4 [shape=diamond];
  }

  subgraph side_services {
    label = "Side services";
    rank = same;
    redis [shape=box]
    kafka [shape=box]
  }

  subgraph support {
    label = "Support";
    rank = same;
    dns_manager [shape=box];
    cert_manager [shape=box];
    load_balancer [shape=box];
    ingress [shape=box];
  }
  load_balancer, dns_manager, cert_manager -> ingress;

  subgraph service {
    label = "Service";
    rank = same;
    logs [shape=box];
    metrics [shape=box];
  }
  logs, metrics -> ingress;
}
---------------------------------------------------------------------

["graphviz", "main_scheme_legend", "svg"]
---------------------------------------------------------------------
digraph main {
  service [shape=diamond,label="Наши сервисы"];
  side_service [shape=box, label="Сторонние сервисы"];
}
---------------------------------------------------------------------
