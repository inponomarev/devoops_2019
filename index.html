<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="author" content="Дмитрий Губенко, КУРС"><title>Terraform vs Helm: Битва за инфраструктуру</title><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport"><link href="reveal.js/css/reveal.css" rel="stylesheet"><link rel="stylesheet" href="white_course.css" id="theme"><!--This CSS is generated by the Asciidoctor-Reveal.js converter to further integrate AsciiDoc's existing semantic with Reveal.js--><style type="text/css">.reveal div.right {
  float: right;
}

/* callouts */
.conum[data-value] {display:inline-block;color:#fff!important;background-color:rgba(50,150,50,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}</style><link href="reveal.js/lib/css/zenburn.css" rel="stylesheet"><script>var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /print-pdf/gi ) ? "reveal.js/css/print/pdf.css" : "reveal.js/css/print/paper.css";
document.getElementsByTagName( 'head' )[0].appendChild( link );</script><!--[if lt IE 9]><script src="reveal.js/lib/js/html5shiv.js"></script><![endif]--><link rel="stylesheet" href="common.css"></head><body><div class="reveal"><div class="slides"><section class="title" data-state="title"><h1>Terraform vs Helm</h1><h2>Битва за инфраструктуру</h2><div class="preamble"><aside class="notes"><div class="paragraph"><p>Приветствие.
Прошлый DevOops, опыт, желание побить.
Облегчение управления инфраструктурой.</p></div></aside></div><p class="author"><small>Дмитрий Губенко, КУРС</small></p></section>
<section><section><div class="dlist"><dl><dt class="hdlist1">Имя</dt><dd><p>Дмитрий Губенко, КУРС</p></dd><dt class="hdlist1">Почта</dt><dd><p><a href="mailto:dmeatriy@gmail.com">dmeatriy@gmail.com</a></p></dd><dt class="hdlist1">Telegram</dt><dd><p>@Dmeatriy</p></dd></dl></div><aside class="notes"><div class="paragraph"><p>О себе:
В ИТ с 2013
В деве с 2015
ЛЭТИ
МИС, госуслуги МО, MVS, Real-time Monitoring, Биоинформатика.
КУРС
Небольшая компания
Проекты по аутсорсу
Прошлогодний доклад про тестирование Ansible-playbooks
Распределенная малочисленная команда</p></div></aside></section><section id="_когда_каждый_может_обидеть"><h2>Когда каждый может обидеть</h2><div class="imageblock" style=""><img src="images/david_&_goliaf.jpg" alt="david & goliaf"></div>
<aside class="notes"><div class="paragraph"><p>Первое впечатление о проекте
Почему попал на проект
Невысокая скорость</p></div></aside></section></section>
<section id="_что_имеем_на_входе"><h2>Что имеем на входе?</h2><div class="ulist"><ul><li class="fragment"><p>Облачный провайдер - DigitalOcean</p></li><li class="fragment"><p>Terraform</p><div class="ulist"><ul><li><p>~1000 строк провайдер-ориентированного кода</p></li><li><p>~100 виртуальных машин</p></li><li><p>~20 dns-записей</p></li></ul></div></li><li class="fragment"><p>Ansible</p><div class="ulist"><ul><li><p>~5000 строк кода</p></li><li><p>~20 плейбуков с пачкой ролей</p></li></ul></div></li></ul></div>
<aside class="notes"><div class="paragraph"><p>Мониторинг реального времени
Проблемы не только у разработчиков</p></div></aside></section>
<section><section id="_что_болит"><h2>Что болит?</h2><div class="ulist"><ul><li class="fragment"><p>Нет быстрого способа переехать к другому провайдеру.</p></li><li class="fragment"><p>МНОГО кода для деплоя</p></li><li class="fragment"><p>Отвратительное масштабирование системы.</p></li><li class="fragment"><p>Деплой тоже требует дебага.</p></li><li class="fragment"><p>Кто ходил на мою ноду?</p></li></ul></div><aside class="notes"><div class="ulist"><ul><li><p>Переезд:</p><div class="ulist"><ul><li><p>digitalocean_droplet</p></li><li><p>digitalocean_dns_record</p></li></ul></div></li><li><p>Ansible exec by Terraform</p></li><li><p>Service-discovery</p></li><li><p>Molecule troubles with docker</p></li><li><p>Грязные руки на проде</p></li></ul></div></aside></section><section><div class="paragraph"><p>Оставь меня, я задержу их.</p></div>
<pre class="highlight listingblock"><code>resource "digitalocean_droplet" "pgdb-dev" {
    image = "31754481"
    name = "pgdb-dev"
    region = "ams2"
    size = "s-2vcpu-2gb"
    private_networking = "true"
    resize_disk = "false"
    ssh_keys = ["${var.ssh_keys}"]
    user_data = "${file("minimal.conf")}"
}</code></pre>
<div class="ulist"><ul><li class="fragment"><p>Ах, если бы только ноды.</p></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p>Image troubles</p></li><li><p>Naming</p></li><li><p>Region</p></li><li><p>Size</p></li><li><p>Volumes</p></li></ul></div></aside></section><section><div class="paragraph"><p>Посыпьте их пеплом</p></div>
<pre class="highlight listingblock"><code>variable "eps_names" { default = ["epsilon400",
                                  "epsilon401",
                                  "epsilon402",
                                  "epsilon403",
                                  "epsilon404",
                                  "epsilon405"] }</code></pre>
<div class="ulist"><ul><li class="fragment"><p>Когда в твою инфраструктуру попадает цикл.</p></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p>Cycle in infra</p></li><li><p>Count, but control</p></li></ul></div></aside></section><section id="_ansible_fu"><h2>Ansible-fu?</h2><div class="ulist"><ul><li class="fragment"><p>Управление inventory для ansible</p></li><li class="fragment"><p>Соблюдение идемпотентности.</p></li><li class="fragment"><p>Конфигурационный ад.</p></li><li class="fragment"><p>Управление сервисами при обновлении.</p></li><li class="fragment"><p>Зависимость от операционной системы.</p></li><li class="fragment"><p>Создание внутренней сети с настройкой ip-tables</p></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p>Dynamic inventory EC2 from box, but DO - py scripts</p></li><li><p>Molecule tests hard to live</p></li><li><p>Node.js install</p></li><li><p>Nginx install with yaml locations</p></li><li><p>Cross-OS roles</p></li></ul></div></aside></section><section><div class="paragraph"><p>Когда каждый ansible-playbook - произведение искусства.</p></div>
<pre class="highlight listingblock"><code>---
- name: configure backoffice server
... 10 more lines
  roles:
    - role: do_hostname
... 20 more lines
    - role: backoffice
  tasks:
... 50 more lines
    - name: Reload nginx
      service:
        name: nginx
        state: reloaded</code></pre>
<div class="ulist"><ul><li class="fragment"><p>Долго, дорого, будет цениться после смерти автора(нет).</p></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p>I love ansible</p></li><li><p>But it so hard</p></li><li><p>Ponomarev helps</p></li></ul></div></aside></section></section>
<section><section id="_а_что_собственно_деплоим"><h2>А что, собственно, деплоим?</h2><div class="imageblock" style=""><img src="main_scheme_joke.png" alt="main scheme joke"></div></section><section id="_а_что_собственно_деплоим_2"><h2>А что, собственно, деплоим?</h2><div class="imageblock" style=""><img src="main_scheme_1.png" alt="main scheme 1"></div>
<div class="imageblock" style=""><img src="main_scheme_legend_.png" alt="main scheme legend "></div></section><section id="_а_что_собственно_деплоим_3"><h2>А что, собственно, деплоим?</h2><div class="imageblock" style=""><img src="main_scheme_2.png" alt="main scheme 2"></div>
<div class="imageblock" style=""><img src="main_scheme_legend_.png" alt="main scheme legend "></div></section><section id="_а_что_собственно_деплоим_4"><h2>А что, собственно, деплоим?</h2><div class="imageblock" style=""><img src="main_scheme_3.png" alt="main scheme 3"></div>
<div class="imageblock" style=""><img src="main_scheme_legend_.png" alt="main scheme legend "></div></section><section id="_сборка_jar_file"><h2>Сборка jar-file</h2><div class="imageblock" style=""><img src="code_cycle.png" alt="code cycle"></div></section><section id="_сборка_docker_образа"><h2>Сборка docker-образа</h2><div class="imageblock" style=""><img src="image_cycle.png" alt="image cycle"></div></section><section id="_я_рассажу_вас_по_стульчикам"><h2>Я рассажу вас по стульчикам</h2><div class="imageblock" style=""><img src="images/before_k8s_after_k8s.jpg" alt="before k8s after k8s"></div></section><section id="_почему_dockerkubernetes"><h2>Почему docker/kubernetes?</h2><div class="ulist"><ul><li class="fragment"><p>Урезать рацион</p></li><li class="fragment"><p>Легко масштабировать</p></li><li class="fragment"><p>Упал - перезапустился</p></li><li class="fragment"><p>Изоляция окружения</p></li><li class="fragment"><p>Собственная межсервисная сеть и dns</p></li></ul></div></section><section id="_почему_облачный_kubernetes"><h2>Почему ОБЛАЧНЫЙ kubernetes?</h2><div class="ulist"><ul><li class="fragment"><p>Легко свернуть-развернуть</p></li><li class="fragment"><p>K8saaS - это недорого</p></li><li class="fragment"><p>У Terraform есть провайдеры, поэтому легко жить с IaC</p></li></ul></div></section><section id="_упаковка_helm_чарта"><h2>Упаковка helm-чарта</h2><div class="imageblock" style=""><img src="chart_cycle.png" alt="chart cycle"></div></section><section id="_почему_helm"><h2>Почему helm?</h2><div class="ulist"><ul><li class="fragment"><p>Пакетный менеджер для сервисов k8s</p></li><li class="fragment"><p>Cloud Native Computing Foundation</p></li><li class="fragment"><p>Большое количество готовых пакетов для классического web</p></li><li class="fragment"><p>Скоро будет Helm 3 без детских болезней(уже есть альфа)</p></li><li class="fragment"><p>Достаточно выбрать другой namespace, и будет dev, test, staging, prod</p></li></ul></div></section><section id="_инфраструктура_тоже_здесь"><h2>Инфраструктура тоже здесь</h2><div class="imageblock" style=""><img src="infra_cycle.png" alt="infra cycle"></div>
<aside class="notes"><div class="paragraph"><p>Новое слово
Кто пользуется?
На прошлом девупсе Антон Бабенко
Рассказ про Атлантис</p></div></aside></section></section>
<section><section id="_atlantis_iac_автоматизация_прямо_из_vcs"><h2>Atlantis - IaC автоматизация прямо из VCS</h2><div class="imageblock" style=""><img src="images/hero.png" alt="hero"></div></section><section id="_некосмический_корабль"><h2>Некосмический корабль</h2><div class="imageblock" style=""><img src="Atlantis_1.png" alt="Atlantis 1"></div></section><section id="_некосмический_корабль_2"><h2>Некосмический корабль</h2><div class="imageblock" style=""><img src="Atlantis_2.png" alt="Atlantis 2"></div></section><section id="_некосмический_корабль_3"><h2>Некосмический корабль</h2><div class="imageblock" style=""><img src="Atlantis_3.png" alt="Atlantis 3"></div></section><section id="_некосмический_корабль_4"><h2>Некосмический корабль</h2><div class="imageblock" style=""><img src="Atlantis_4.png" alt="Atlantis 4"></div></section></section>
<section><section id="_не_будем_отвлекаться"><h2>Не будем отвлекаться</h2><div class="imageblock" style=""><img src="all_cycle.png" alt="all cycle"></div></section><section id="_не_будем_отвлекаться_2"><h2>Не будем отвлекаться</h2><div class="imageblock" style=""><img src="all_cycle_interest.png" alt="all cycle interest"></div></section><section data-transition="none"><div class="imageblock" style=""><img src="terraform_initial1.png" alt="terraform initial1"></div></section><section><div class="imageblock" style=""><img src="terraform_initial5.png" alt="terraform initial5"></div></section><section><div class="imageblock" style=""><img src="terraform_initial6.png" alt="terraform initial6"></div></section><section><div class="imageblock" style=""><img src="terraform_initial7.png" alt="terraform initial7"></div></section><section id="_всё_хорошо_почти"><h2>Всё хорошо. Почти.</h2><div class="ulist"><ul><li class="fragment"><p>Правая рука не знает, что делает левая.</p></li><li class="fragment"><p>Для каждого изменения - терраформ.</p></li></ul></div></section></section>
<section><section id="_terraform_это_хорошо"><h2>Terraform - это хорошо.</h2></section><section id="_из_пушки_по_воробьям"><h2>Из пушки по воробьям?</h2><div class="ulist"><ul><li class="fragment"><p>Добавить/убавить ноду в пул.</p></li><li class="fragment"><p>Добавить/убавить поду в сервис.</p></li><li class="fragment"><p>Пробросить dns-запись.</p></li><li class="fragment"><p>Настроить load-balancing.</p></li><li class="fragment"><p>Добавить https.</p></li></ul></div></section></section>
<section><section id="_helm_как_способ_управления_инфраструктурой"><h2>Helm как способ управления инфраструктурой</h2></section><section id="_какие_есть_инструменты"><h2>Какие есть инструменты?</h2><div class="ulist"><ul><li class="fragment"><p>Cluster-autoscaler</p></li><li class="fragment"><p>Cluster-overprovisioner</p></li><li class="fragment"><p>External-dns</p></li><li class="fragment"><p>Nginx-ingress</p></li><li class="fragment"><p>Cert-manager</p></li><li class="fragment"><p>HPA</p></li></ul></div>
<aside class="notes"><div class="paragraph"><p>HPA - Иван Глушков - Postmates</p></div></aside></section></section>
<section><section id="_cluster_autoscaler"><h2>Cluster-autoscaler</h2><div class="ulist"><ul><li class="fragment"><p>Manages autoscaling groups</p></li><li class="fragment"><p>AWS, GCE, Azure AKS</p></li><li class="fragment"><p>Autodiscovery by ASG tags</p></li><li class="fragment"><p>Manually specify ASG(aws only!)</p></li></ul></div></section><section id="_cluster_autoscaler_iam_permissions"><h2>Cluster-autoscaler - IAM permissions</h2><pre class="highlight listingblock"><code>  {
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "autoscaling:DescribeAutoScalingGroups",
                "autoscaling:DescribeAutoScalingInstances",
                "autoscaling:DescribeLaunchConfigurations",
                "autoscaling:SetDesiredCapacity",
                "autoscaling:TerminateInstanceInAutoScalingGroup"
            ],
            "Resource": "*"
        }
    ]
}</code></pre></section><section id="_cluster_autoscaler_values_yml"><h2>Cluster-autoscaler - values.yml</h2><pre class="highlight listingblock"><code>cluster-autoscaler:
  autoscalingGroups:
    - name: asg1
      maxSize: 1
      minSize: 10
  awsRegion: us-east-1</code></pre>
<div class="ulist"><ul><li class="fragment"><p>Можно организовать autoDiscovery, но придется тогда создавать asg через терраформ.</p></li></ul></div></section></section>
<section><section id="_cluster_overprovisioner"><h2>Cluster-overprovisioner</h2><div class="ulist"><ul><li class="fragment"><p>Holds resources for service pods</p></li><li class="fragment"><p>HOT autoscaling</p></li><li class="fragment"><p>Low PriorityClass</p></li></ul></div></section><section id="_cluster_overprovisioner_2"><h2>Cluster-overprovisioner</h2><pre class="highlight listingblock"><code>helm install stable/cluster-overprovisioner</code></pre></section></section>
<section><section id="_external_dns"><h2>External-dns</h2><div class="ulist"><ul><li class="fragment"><p>Make services discoverable</p></li><li class="fragment"><p>AWS Route 53, GC DNS stable</p></li><li class="fragment"><p>AWS SD, AzureDNS, CloudFlare beta</p></li><li class="fragment"><p>15+ DNS alpha</p></li></ul></div></section><section id="_external_dns_iam_permissions"><h2>External-dns IAM Permissions</h2><pre class="highlight listingblock"><code>{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "route53:ListHostedZones",
        "route53:ListResourceRecordSets",
        "route53:ChangeResourceRecordSets"
      ],
      "Resource": "*"
    }
  ]
}</code></pre>
<div class="ulist"><ul><li class="fragment"><p>Можно отталкиваться от минимальных прав,
создавая hosted-zone через terraform.</p></li></ul></div></section><section id="_external_dns_nginx_ingress_values_yaml"><h2>External-dns nginx-ingress values.yaml</h2><pre class="highlight listingblock"><code>controller:
    ingressClass: elb
    service:
      annotations:
        external-dns.alpha.kubernetes.io/hostname: service1.example.com</code></pre></section></section>
<section id="_nginx_ingress"><h2>Nginx-ingress</h2><div class="ulist"><ul><li class="fragment"><p>Load-balancing by Kubernetes API</p></li><li class="fragment"><p>Providers</p><div class="ulist"><ul><li><p>AWS ELB</p></li><li><p>DO</p></li><li><p>Google Cloud</p></li></ul></div></li><li class="fragment"><p>Has default-backend</p></li></ul></div></section>
<section><section id="_cert_manager"><h2>Cert-manager</h2><div class="ulist"><ul><li class="fragment"><p>Provision and manage TLS certificates</p></li><li class="fragment"><p>Maintainer - Jetstack</p></li><li class="fragment"><p>Pre-1.0</p></li><li class="fragment"><p>Issuers</p><div class="ulist"><ul><li><p>CA</p></li><li><p>Self-Signed</p></li><li><p>ACME</p></li><li><p>Vault</p></li><li><p>Venafi</p></li></ul></div></li></ul></div></section><section id="_cert_manager_installation"><h2>Cert-manager installation</h2><pre class="highlight listingblock"><code>kubectl apply --validate=false -f https://raw.githubusercontent.com/jetstack/cert-manager/release-0.11/deploy/manifests/00-crds.yaml
kubectl create namespace cert-manager
helm repo add jetstack https://charts.jetstack.io
helm repo update
helm install \
  --name cert-manager \
  --namespace cert-manager \
  --version v0.11.0 \
  jetstack/cert-manager</code></pre></section><section id="_chart_annotations_for_ingresstls"><h2>Chart annotations for ingress/tls:</h2><pre class="highlight listingblock"><code>grafana:
  ingress:
    enabled: true
    hosts:
      - grafana.example.com
    annotations:
      kubernetes.io/ingress.class: elb
      ingress.kubernetes.io/ssl-redirect: "true"
      kubernetes.io/tls-acme: "true"
      certmanager.k8s.io/issuer: letsencrypt-staging
    tls:
      - secretName: grafana-tls
        hosts:
          - grafana.example.com</code></pre></section><section id="_issuer_for_cert_manager"><h2>Issuer for cert-manager</h2><pre class="highlight listingblock"><code>apiVersion: cert-manager.io/v1alpha2
kind: ClusterIssuer
metadata:
  name: letsencrypt-staging
spec:
  acme:
    email: user@example.com
    server: https://acme-staging-v02.api.letsencrypt.org/directory
    privateKeySecretRef:
      name: example-issuer-account-key
    solvers:
    - http01:
        ingress:
          class: elb</code></pre></section><section id="_certificate_for_cert_manager"><h2>Certificate for cert-manager</h2><pre class="highlight listingblock"><code>apiVersion: cert-manager.io/v1alpha2
kind: Certificate
metadata:
  name: example-com
  namespace: default
spec:
  secretName: example-com-tls
  duration: 2160h # 90d
  renewBefore: 360h # 15d
  commonName: example.com
  dnsNames:
  - example.com
  - www.example.com
  uriSANs:
  - spiffe://cluster.local/ns/sandbox/sa/example
  issuerRef:
    name: letsencrypt-staging
    kind: ClusterIssuer</code></pre></section></section>
<section><section id="_terraform_как_способ_инициализации"><h2>Terraform как способ инициализации.</h2><aside class="notes"><div class="paragraph"><p>Имприматура - термин, используемый в живописи: цветная тонировка поверхности уже готового белого грунта.</p></div></aside></section><section id="_в_terraform_остаются"><h2>В Terraform остаются:</h2><div class="ulist"><ul><li class="fragment"><p>Заказ кластера и (опционально) node-pool</p></li><li class="fragment"><p>Secrets для Kubernetes(credentials для Artifactory)</p></li><li class="fragment"><p>Инициализация Helm-tiller</p></li><li class="fragment"><p>Первичная установка Helm-chart c указанием namespaces</p></li></ul></div></section><section><pre class="highlight listingblock"><code>resource "digitalocean_kubernetes_cluster" "melbet2" {
  name    = "melbet"
  region  = "lon1"
  version = "1.14.2-do.0"

  node_pool {
    name       = "puppetheatre-pool"
    size       = "s-4vcpu-8gb"
    node_count = 10
    tags       = ["puppetheatre"]
  }

}</code></pre>
<div class="dlist"><dl><dt class="hdlist1">Итого</dt><dd><p>144 строки для DigitalOcean</p></dd></dl></div></section><section><pre class="highlight listingblock"><code>resource "google_container_cluster" "melbet" {
  name               = "melbet-cluster"
  location               = "europe-north1-a"
  remove_default_node_pool = true
  initial_node_count = 1
  enable_legacy_abac = true
  provisioner "local-exec" {
    when    = "destroy"
    command = "sleep 90"
  }
}</code></pre>
<div class="dlist"><dl><dt class="hdlist1">Итого</dt><dd><p>144 строки для GCP</p></dd></dl></div></section><section id="_при_переезде_из_do_в_gcp_меняется_20_строк"><h2>При переезде из DO в GCP меняется ~20 строк</h2></section><section><pre class="highlight listingblock"><code>resource "aws_eks_cluster" "tf_eks" {
  name            = "${var.eks_cluster-name}"
  role_arn        = "${aws_iam_role.tf-eks-master.arn}"
  version         = "1.14"

  vpc_config {
    security_group_ids = ["${module.security_groups.tf-eks-master-id}"]
    subnet_ids         = ["${module.subnet_id1}", "${module.subnet_id2}"]
  }

  depends_on = [
    "aws_iam_role_policy_attachment.tf-cluster-AmazonEKSClusterPolicy",
    "aws_iam_role_policy_attachment.tf-cluster-AmazonEKSServicePolicy",
  ]
}</code></pre>
<div class="dlist"><dl><dt class="hdlist1">Итого</dt><dd><p>510 строк для AWS(вместе с кастомными IAM)</p></dd></dl></div></section><section id="_а_как_насчет_bare_metal"><h2>А как насчет Bare Metal?</h2><div class="ulist"><ul><li class="fragment"><p>Гипотетически - Rancher2 имеет свой провайдер в Terraform</p></li></ul></div></section><section id="_при_переезде_в_aws_пришлось_потрудиться_но_на_то_он_и_aws"><h2>При переезде в AWS пришлось потрудиться, но на то он и AWS</h2></section></section>
<section><section id="_проблемы"><h2>Проблемы</h2></section><section id="_helm_tiller"><h2>Helm tiller</h2><div class="ulist"><ul><li class="fragment"><p>Всегда неприятно иметь cluster-admin на своём кластере</p></li><li class="fragment"><p>Можно поднимать локально, тогда будет пользоваться вашими правами</p></li><li class="fragment"><p><a href="https://habr.com/ru/company/oleg-bunin/blog/462665" class="bare">https://habr.com/ru/company/oleg-bunin/blog/462665</a> - статья по безопасности Helm, которая может слегка смягчить боль</p></li><li class="fragment"><p>С выходом Helm3 станет неактуальным.</p></li></ul></div></section><section id="_persistence"><h2>Persistence</h2><div class="ulist"><ul><li class="fragment"><p>Грамотный persistence management просто необходим</p></li><li class="fragment"><p>Неактуальным не станет</p></li></ul></div></section><section id="_kafka"><h2>Kafka</h2><div class="ulist"><ul><li class="fragment"><p>Оригинальный helm-chart от Confluent - требует квалификации для варения.</p></li><li class="fragment"><p>Современные библиотеки клиентов - с трудом это переживают.</p></li><li class="fragment"><p>Можно выложить за отдельный load-balancer</p></li><li class="fragment"><p>Купить сервис и забыть.</p></li></ul></div></section></section>
<section><section id="_и_вот_что_мы_получим"><h2>И вот что мы получим</h2><div class="ulist"><ul><li class="fragment"><p>Легко переехать к другому провайдеру</p></li><li class="fragment"><p>Мало инфраструктурного кода</p></li><li class="fragment"><p>Легко масштабироваться</p></li><li class="fragment"><p>Легко поддерживать несколько контуров</p></li></ul></div></section><section id="_что_почитатьпосмотреть"><h2>Что почитать/посмотреть?</h2><div class="ulist"><ul><li class="fragment"><p>Флант блог <a href="https://habr.com/ru/company/flant" class="bare">https://habr.com/ru/company/flant</a></p></li><li class="fragment"><p>Atlantis <a href="https://www.runatlantis.io" class="bare">https://www.runatlantis.io</a></p></li><li class="fragment"><p>Google блог <a href="https://cloud.google.com/blog/products/devops-sre" class="bare">https://cloud.google.com/blog/products/devops-sre</a></p></li></ul></div></section><section id="_выводы"><h2>Выводы</h2></section><section id="_разгружайте_ваш_terraform"><h2>Разгружайте ваш Terraform</h2><div class="paragraph"><p>Минималистичная инфраструктура с гибким подходом к переезду.</p></div></section><section id="_нагружайте_ваш_helm"><h2>Нагружайте ваш Helm</h2><div class="paragraph"><p>Пакетный менеджер с легкостью справляется с задачами инфраструктуры в пределах сервиса.</p></div></section><section id="_на_ваши_вопросы_ответит"><h2>На ваши вопросы ответит</h2><div class="dlist"><dl><dt class="hdlist1">Имя</dt><dd><p>Дмитрий Губенко, КУРС</p></dd><dt class="hdlist1">Почта</dt><dd><p><a href="mailto:dmeatriy@gmail.com">dmeatriy@gmail.com</a></p></dd><dt class="hdlist1">Telegram</dt><dd><p>@Dmeatriy</p></dd></dl></div></section></section></div></div><script src="reveal.js/lib/js/head.min.js"></script><script src="reveal.js/js/reveal.js"></script><script>Array.prototype.slice.call(document.querySelectorAll('.slides section')).forEach(function(slide) {
  if (slide.getAttribute('data-background-color')) return;
  // user needs to explicitly say he wants CSS color to override otherwise we might break custom css or theme (#226)
  if (!(slide.classList.contains('canvas') || slide.classList.contains('background'))) return;
  var bgColor = getComputedStyle(slide).backgroundColor;
  if (bgColor !== 'rgba(0, 0, 0, 0)' && bgColor !== 'transparent') {
    slide.setAttribute('data-background-color', bgColor);
    slide.style.backgroundColor = 'transparent';
  }
})

// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display presentation control arrows
  controls: true,
  // Help the user learn the controls by providing hints, for example by
  // bouncing the down arrow when they first encounter a vertical slide
  controlsTutorial: true,
  // Determines where controls appear, "edges" or "bottom-right"
  controlsLayout: 'bottom-right',
  // Visibility rule for backwards navigation arrows; "faded", "hidden"
  // or "visible"
  controlsBackArrows: 'faded',
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: 'true',
  // Control which views the slide number displays on
  showSlideNumber: 'all',
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: false,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Randomizes the order of slides each time the presentation loads
  shuffle: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags whether to include the current fragment in the URL,
  // so that reloading brings you to the same fragment position
  fragmentInURL: false,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Flags if we should show a help overlay when the questionmark
  // key is pressed
  help: true,
  // Flags if speaker notes should be visible to all viewers
  showNotes: false,
  // Global override for autolaying embedded media (video/audio/iframe)
  // - null: Media will only autoplay if data-autoplay is present
  // - true: All media will autoplay, regardless of individual setting
  // - false: No media will autoplay, regardless of individual setting
  autoPlayMedia: null,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Use this method for navigation when auto-sliding
  autoSlideMethod: Reveal.navigateNext,
  // Specify the average time in seconds that you think you will spend
  // presenting each slide. This is used to show a pacing timer in the
  // speaker view
  defaultTiming: 120,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  // Add `data-preview-link` and `data-preview-link="false"` to customise each link
  // individually
  previewLinks: false,
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: 'none',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',
  // Number of pixels to move the parallax background per slide
  // - Calculated automatically unless specified
  // - Set to 0 to disable movement along an axis
  parallaxBackgroundHorizontal: null,
  parallaxBackgroundVertical: null,
  // The display mode that will be used to show slides
  display: 'block',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1600,
  height: 900,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
      { src: 'reveal.js/plugin/notes/notes.js', async: true },
      
      
      
      
  ],

  

});</script></body></html>